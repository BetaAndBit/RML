<html xmlns="http://www.w3.org/1999/xhtml"><head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=0.5, minimum-scale=0.5, user-scalable=yes, maximum-scale=2.0, target-densitydpi=device-dpi" />
				<meta name="robots" content="all"/>
        <meta name="description" content="The Hitchhiker's Guide to Responsible Machine Learning">
        <meta name="keywords" content="">
        <title>The Hitchhiker's Guide to Responsible Machine Learning</title>
<style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
}
  
#container {margin:50px auto;padding:0px;width:910px;}
#left-button{ width:90px; height:100%;float:left }
#middle{ width:730px; margin:0px; float: left;}
#right-button{ width:90px; float:left;}
html, body, div, ul, li, dl, dt, dd, h1, h2, h3, h4, h5, h6, form, input, dd,select, button, textarea, iframe, table, th, td { margin: 0; padding: 0; }
img { border: 0 none; displayblock}
span,ul,li,image{ padding:0px; margin:0px; list-style:none;}
#top-title{ width:714px; margin-bottom:10px; float:left; padding:0px 8px}
#top-title2{ width:320px;  float:right;}
#content{ width: 730px; float:left;float:left;word-wrap: break-word;}
#content-top{ width:730px; background-image:url(images/top_bg.jpg); height:56px; background-repeat:no-repeat; float:left;}
#content-top1{ width:70%; padding:16px 0px 0px 30px; font-family:Arial, Helvetica, sans-serif; font-size:24px; color:#636363;float:left;}
#content-top2{ width:60px; float:right; padding:25px 30px 0px 0px;font-family:Arial, Helvetica, sans-serif; font-size:11px; color:#2f2f2f; font-weight:bold; text-align:right}
#content-middle{ width:730px; background-image:url(images/middle_bg.jpg); background-repeat:repeat-y;float:left;}
#content-middle1{ width:475px; padding:25px 0px 25px 35px; font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#636363; line-height:150%;float:left;}
#content-middle2{  padding:7px; float:right; margin:25px 35px 0px 0px; border:solid 1px #c8c8c9; background-color:#FFF; text-align:center}
#content-bottom{ width:730px; background-image:url(images/bottom_bg.jpg); background-repeat:no-repeat; height:58px;float:left;}
#content-bottom2{ width:110px; height:42px; margin:0px auto; padding-top:4px;}
#input{ width:58px; height:20px; background-color:#FFF; border:solid 1px #dfdfe0; color:#636363; text-align:center; font-size:11px;}
.font1{ font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#2f2f2f;}
.font1 a:link{
	text-decoration: none;
    color:#2f2f2f;

}
.font1 a:visited{
	text-decoration: none;
    color:#2f2f2f;
	
}
.font1 a:hover{
	color: #2f2f2f;
	text-decoration: underline;

}



.text-container {
padding: 20px;
color: #333;
margin-top: 24px;
line-height: 22px;
border-top-left-radius: 3px;
border-top-right-radius: 3px;
}

.use-as-video {
float: right;
padding-left: 20px;
}
.cc-float-fix:before, .cc-float-fix:after {
content: "";
line-height: 0;
height: 0;
width: 0;
display: block;
visibility: hidden;
}
.use-as-video-img {
cursor: pointer;
position: relative;
width: 320px;
height: 180px;
}
.use-as-video-title {
font-size: 15px;
font-weight: bold;
color: #000000;
padding-bottom: 5px;
}
-->
</style>
<script type="text/javascript">
<!--
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}
//-->
</script>
</head>

<body onload="MM_preloadImages('images/next2.png','images/previous2.png')">
<div id="container">
<div id="left-button">
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p><a href="page30.html"><img src="images/previous_big.png" width="90" height="80" /></a></p>
</div>
<div id="middle">
  <div id="top-title"><span class="font1">Basic HTML Version</span>
    <div id="top-title2">
      <table width="100%" border="0" align="right" cellpadding="0" cellspacing="0">
        <tr>
        	<td width="66%"> </td>
          <td width="35%" style="display:none" align="right"><img src="images/content.png" width="19" height="16" /></td>
          <td width="31%" style="display:none" class="font1"><a href="">Table of Contents</a></td>
          <td width="6%"><img src="images/view.png" width="19" height="16" /></td>
          <td width="28%" class="font1"><a href="../../The_Hitchhiker_s_Guide_to_Responsible_Machine_Learning_2021_08_21.html">View Full Version</a></td>
        </tr>
      </table>
    </div>
  </div>
  <div id="content">
     <div id="content-top">
        <div id="content-top1">Page 31 - The Hitchhiker's Guide to Responsible Machine Learning</div>
        <div id="content-top2">P. 31</div>
     </div>
     <div id="content-middle">
     	
     	  <div class="text-container">
    <div class="use-as-video cc-float-fix">
      <a style="text-decoration: none;" href="../../The_Hitchhiker_s_Guide_to_Responsible_Machine_Learning_2021_08_21.html#p=31"><img src="../thumb/31.jpg" /></a>
    </div>

    <p class="use-as-video-title"></p>
    <pre style="white-space:pre-line"><code>31
Model Assembly
For automatic hyperparameter search, it is necessary to specify: (1) a procedure to evaluate the performance of the proposed models, below it is the AUC determined by 5-fold cross-validation, (2) a se- arch strategy for the parameter space, below it is a random search, (3) a stopping criterion, below it is the number of 10 evaluations34.
34 Of course, Bit having a High Per- formance Cluster (HPC) can check hundreds of thousands of hyperpa- rameter configurations as the who- le process is easily parallelized. Ho- wever, in this example we have fo- cused on reproducibility, so we pre- sent results for 10 configurations, making it easy for any reader to reproduce these results. Also, for this dataset, the default random fo- rest parameters give very good re- sults, so we wouldn’t gain much with long tuning anyway.
35 Note, that the AUC 0.9272979 presented below is not calculated on the covid_summer, but it is inter- nal evaluation of hyperparameters with the 5-fold CV procedure. AUC on the covid_summer is presented on the bottom of this page.
36 Moreover, some algorithms, like random forests, are not very tuna- ble. Still, we had to try!
Receiver Operator Characteristic
     _
tuned ranger =
    learner
    resampling = rsmp("cv", folds = 5),
    measure    = msr("classif.auc"),
    search_space = search_space,
                               _
    terminator = trm("evals", n evals = 10),
    tuner      = tnr("random_search") )
Once the optimization parameters have been defined, we can turn on their optimization with the train method, just as with any other predictive model in mlr3 framework35.
tuned_ranger$train(covid_task)
tuned_ranger$tuning_result
#    num.trees max.depth    minprop splitrule
# 1:       264         9 0.06907318      gini
#    learner_param_vals  x_domain classif.auc
# 1:          &lt;list[4]&gt; &lt;list[4]&gt;   0.9272979
There is, of course, no guarantee that the tuner will find better hyperparameters than the default ones36. But in this example, the tuned model is better than all other models that we have considered so far. Let’s see how much. We need an DALEX wrapper.
model_tuned &lt;- explain(tuned_ranger, predict_function = function(m,x)
        m$predict_newdata(newdata = x)$prob[,1],
    data = covid_summer,
    y = covid_summer$Death == "Yes",
    type = "classification", label = "AutoTune")
So we can calculate and compare model performance/AUC on validation data and then compare ROC curves for various models.
(mp_tuned &lt;- model_performance(model_tuned))
# Measures for:  classification
# recall     : 0.02575107
# precision  : 0.4
AutoTuner$new(
= covid_ranger,
Model Ranger 1.00
0.75
0.50
0.25
0.00
0.00 0.25
Figure 13: ROC curves for the CDC, tree, ranger model and auto tune ranger model.
AutoTune CDC Tree
          # f1
# accuracy
# auc
# See Figure 13
plot(mp_tuned, mp_ranger, mp_tree, mp_cdc, geom = "roc")
Note on reproducibility: Take into account that the training is based on randomization, so you may get slightly different results on different computers or with different versions of packages. Even if you execute the same snippet twice, you may get slightly different results. Nevertheless, the general conclusions should be the same.
: 0.0483871
: 0.9764
: 0.9447171
0.50 0.75 1.00 False positive rate
True positive rate












































</code></pre>
     	</div>
    
     </div>
     <div id="content-bottom">
       <div id="content-bottom2">
         <table width="110" border="0" cellspacing="0" cellpadding="0">
           <tr>
             <td width="22%" height="44"><a href="page30.html"><img src="images/previous.png" width="26" height="19" id="Image2" onmouseover="MM_swapImage('Image2','','images/previous2.png',1)" onmouseout="MM_swapImgRestore()" /></a></td>
             <td width="43%">
             	&nbsp;&nbsp;&nbsp;<a href="page29.html">29</a>&nbsp;&nbsp;&nbsp;<a href="page30.html">30</a>&nbsp;&nbsp;&nbsp;31&nbsp;&nbsp;&nbsp;<a href="page32.html">32</a>&nbsp;&nbsp;&nbsp;<a href="page33.html">33</a>&nbsp;&nbsp;&nbsp;</td>
             <td width="35%"><a href="page32.html"><img src="images/next.png" width="26" height="19" id="Image1" onmouseover="MM_swapImage('Image1','','images/next2.png',1)" onmouseout="MM_swapImgRestore()" /></a></td>
           </tr>
         </table>
       </div>
     </div>
  </div>
</div>
<div id="right-button">
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p><a href="page32.html"><img src="images/next_big.png" width="90" height="80" /></a></p>
</div>

</div>
</body>
</html>
